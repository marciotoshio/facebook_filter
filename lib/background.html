<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="facebook_options.js"></script>
		<script type="text/javascript">
			//Badge
			chrome.browserAction.setBadgeBackgroundColor({'color': [53,79,130,255]});
			chrome.browserAction.setBadgeText({'text': '0'});
		
			//Options
			var options = new FacebookFilter.Options();
		
			//Context menu
			chrome.contextMenus.create({
				'title': chrome.i18n.getMessage('contextMenu'),
				'contexts': ['selection'],
				'onclick': function (info) {
					var key = info.selectionText;
					options.addKey(key);
					chrome.tabs.getSelected(null, function(tab) {
						chrome.tabs.sendRequest(tab.id, {filterKey: key});
					});
				}
			});
			
			//Extension and Content_Script communication
			chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
				if (request.method == 'getOptions') {
					sendResponse(options.getOptions());
				}
				else if (request.method == 'setBadgeText') {
					chrome.browserAction.setBadgeText({'text': request.value.toString()});
				}
				else {
					sendResponse({});
				}
			});
		</script>
	</head>
	<body></body>
</html>