<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="facebook_options.js"></script>
		<script type="text/javascript">
			//Badge
			chrome.browserAction.setBadgeBackgroundColor({'color': [53,79,130,255]});
			chrome.browserAction.setBadgeText({'text': '0'});
		
			//Options
			var options = new FacebookFilter.Options();
		
			//Context menu
			chrome.contextMenus.create({
				'title': 'Filter by message body with: %s',
				'contexts': ['selection'],
				'onclick': function (info) {
					options.addMessageBodyKey(info.selectionText);
				}
			});
			
			chrome.contextMenus.create({
				'title': 'Filter by author with: %s',
				'contexts': ['selection'],
				'onclick': function (info) {
					options.addAuthorKey(info.selectionText);
				}
			});
			
			chrome.contextMenus.create({
				'title': 'Filter by attachment with: %s',
				'contexts': ['selection'],
				'onclick': function (info) {
					options.addAttachmentKey(info.selectionText);
				}
			});
			
			//Extension and Content_Script communication
			chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
				if (request.method == 'getOptions') {
					sendResponse(options.getOptions());
				}
				else if (request.method == 'setBadgeText') {
					chrome.browserAction.setBadgeText({'text': request.value.toString()});
				}
				else {
					sendResponse({});
				}
			});
		</script>
	</head>
	<body></body>
</html>